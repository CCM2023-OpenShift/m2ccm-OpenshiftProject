# üìÅ .github/workflows/ci.yml
name: CI - Maven Quality Checks

on:
  push:
  pull_request:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # ‚úÖ 1. Cloner le d√©p√¥t
      - uses: actions/checkout@v4

      # ‚úÖ 2. Installation de Java 17 et Maven
      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: 17
          distribution: temurin
          cache: maven

      # ‚úÖ 3. Compilation et V√©rification
      - name: Build with Maven
        run: ./mvnw clean verify --no-transfer-progress

      # ‚úÖ 4. Qualit√© du Code : Checkstyle, PMD, SpotBugs
      - name: Code Quality Checks
        run: |
          ./mvnw checkstyle:check
          ./mvnw pmd:check
          ./mvnw spotbugs:check

      # ‚úÖ 5. Upload des Rapports (en cas d'√©chec)
      - name: Upload Reports
        if: always()  # ‚úÖ T√©l√©verse m√™me si le workflow √©choue ou r√©ussit
        uses: actions/upload-artifact@v4
        with:
          name: Reports
          path: |
            target/reports/pmd/**          # ‚úÖ Upload tout le dossier PMD (HTML, JS, CSS)
            target/checkstyle/checkstyle.html
          retention-days: 7                # ‚úÖ Conserve les fichiers pendant 7 jours
